{
    "deletes":{
        "cycle_job_artifact":{

            "sql":"DELETE FROM job_artifact WHERE job_id IN (REP0)",
            "host_type": "master_host"
        },
        "cycle_job":{

            "sql":"DELETE FROM job WHERE id IN (REP0)",
            "host_type": "master_host"
        }
    },
    "inserts":{
        "create_job_data":{
            "sql":"INSERT INTO `job` (
                `job_guid`,
                `signature`,
                `job_coalesced_to_guid`,
                `result_set_id`,
                `push_id`,
                `build_platform_id`,
                `machine_platform_id`,
                `machine_id`,
                `option_collection_hash`,
                `job_type_id`,
                `product_id`,
                `who`,
                `reason`,
                `result`,
                `state`,
                `submit_timestamp`,
                `start_timestamp`,
                `end_timestamp`,
                `running_eta`,
                `tier`)
                SELECT ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?
                FROM DUAL WHERE NOT EXISTS (
                    SELECT `job_guid`
                    FROM `job`
                    WHERE `job_guid` = ?
                    OR `job_guid` = ?
                )",

            "host_type":"master_host"
        }
    },

    "updates": {
        "set_state":{

            "sql":"UPDATE `job`
                SET    `state` = ?
                WHERE  `id` = ?
                AND `state` <> 'completed'",

                "host_type":"master_host"
        },
        "cancel_all":{

            "sql":"UPDATE `job`
                   SET    `state` = 'completed', `result` = 'usercancel'
                   WHERE  `push_id` = ?
                   AND `state` = 'pending'",

                "host_type":"master_host"
        },
        "cancel_job":{

            "sql":"UPDATE `job`
                   SET    `state` = 'completed', `result` = 'usercancel'
                   WHERE  `job_guid` = ?
                   AND `state` = 'pending'",

                "host_type":"master_host"
        },
        "update_job_data":{
            "sql":"
                UPDATE `job`
                SET
                `job_guid` = ?,
                `job_coalesced_to_guid` = ?,
                `result_set_id` = ?,
                `push_id` = ?,
                `machine_id` = ?,
                `option_collection_hash` = ?,
                `job_type_id` = ?,
                `product_id` = ?,
                `who` = ?,
                `reason` = ?,
                `result` = ?,
                `state` = ?,
                `start_timestamp` = ?,
                `end_timestamp` = ?
                WHERE
                    `state` != 'completed'
                AND ? <> 'pending'
                AND `id` = ?",

            "host_type":"master_host"
        },
        "update_coalesced_guids":{
            "sql":"UPDATE `job`
                   SET `job_coalesced_to_guid` = ?
                   WHERE `job_guid` = ?",

            "host_type":"master_host"
        },
        "update_last_job_classification":{
            "sql":"UPDATE `job`
                   SET `failure_classification_id` = ?
                   WHERE id = ?",

            "host_type":"master_host"
        }
    },
    "selects":{
        "get_jobs_to_cycle":{
            "sql":"SELECT id, job_guid FROM job WHERE submit_timestamp < ?",
            "host_type":"master_host"
        },
        "get_job_ids_by_guids":{
            "sql":"SELECT `id`, `job_guid`, `push_id`, `state`, `result`
                   FROM `job`
                   WHERE `active_status` = 'active' AND `job_guid` IN (REP0)",
            "host_type": "master_host"
        },
        "get_jobs_by_coalesced_guids":{

            "sql":"SELECT `id`, `job_guid`, `job_coalesced_to_guid`
                   FROM `job`
                   WHERE `job_coalesced_to_guid` IN (REP0)",

            "host_type": "read_host"

        }
    }
}
